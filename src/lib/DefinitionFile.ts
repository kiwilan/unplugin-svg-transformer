import { Utils } from './Utils'

/**
 * To create definition file.
 */
export class DefinitionFile {
  protected constructor(
    protected contents?: string,
  ) {}

  public static async make(types: string): Promise<DefinitionFile> {
    const self = new DefinitionFile(types)

    const contents = [
      '/* eslint-disable */',
      '/* prettier-ignore */',
      '// @ts-nocheck',
      '// Generated by unplugin-svg-transformer',
      'export {};',
      '',
      'declare global {',
      `  ${types}`,
      '  interface Window {',
      '    iconList: Record<IconType, Promise<{ default: string }>>',
      '    importIcon: (name: IconType) => Promise<{ default: string }>',
      '  }',
      '}',
      '',
      'declare module \'vue\' {',
      '  export interface GlobalComponents {',
      '    SvgIcon: typeof import(\'unplugin-svg-transformer/dist/components\')[\'VueSvg\']',
      '    importIcon: (name: IconType) => Promise<{ default: string }>',
      '  }',
      '}',
      '',
      'window.iconList = window.iconList || {}',
      'window.importIcon = importIcon || function () {}',
      '',
    ]

    self.contents = contents.join('\n')

    return self
  }

  public getContents(): string {
    return this.contents!
  }
}
